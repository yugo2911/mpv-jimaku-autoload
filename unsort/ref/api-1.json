{
  "openapi": "3.0.3",
  "info": {
    "title": "Jimaku",
    "description": "### Overview\n\nWelcome to the Jimaku API. You can use this API to access the contents of the site. The API is based off of a simple REST API with a few endpoints.\n\n### Authentication\n\nJimaku uses API keys to allow access to the API. Authentication is done using the `Authorization` header. Note that in order to use this API, an account is required. Please [register](/login) if you have not done so already.\n\nIf you have not generated an API key yet, you can do so on your [account page](/account).\n\n### Core Concepts\n\nJimaku is basically a directory listing where every [Entry](#model/entry) represents a directory. These directories are backed by either a TMDB ID or an AniList ID. Users with editor privileges can bypass this requirement for extraordinary cases.\n\nEach directory entry has a set of files that can be downloaded.\n\n#### TMDB ID\n\nA TMDB ID is encoded in string form in either `tv:id` or `movie:id` form (for example, `tv:1234`). In the future this syntax might be extended to support seasons in a TV show.\n\n### Rate Limits\n\nRate limits are enforced at an IP level to prevent abuse and spam on the service. When a rate limit is hit, an HTTP 429 status code is returned with some header information telling you how to proceed.\n\n#### Header Format\n\nThe following headers are returned when using a rate limited endpoint:\n\n```\nx-ratelimit-limit: 25\nx-ratelimit-remaining: 14\nx-ratelimit-reset: 1713373688\nx-ratelimit-reset-after: 0.98\n```\n- **x-ratelimit-limit**: The number of requests that can be made.\n- **x-ratelimit-remaining**: How many requests are left before hitting a 429.\n- **x-ratelimit-reset**: The UNIX timestamp (seconds since midnight UTC on January 1st 1970) at which the rate limit resets. This can have a fractional component for milliseconds.\n- **x-ratelimit-reset-after**: The total time in seconds to wait for the rate limit to restart. This can have a fractional component for milliseconds.\n\n### Support\n\nIf you need any more help, or if you want to report a bug or request a feature, please don't hesitate to [contact us](/contact).\n",
    "license": {
      "name": "AGPL-v3"
    },
    "version": "beta"
  },
  "paths": {
    "/api/entries/{id}": {
      "get": {
        "tags": [
          "entries"
        ],
        "summary": "Details",
        "description": "Get the top level details of an entry by its ID.",
        "operationId": "get_entry_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "The entry's ID",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved entry",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Entry"
                }
              }
            }
          },
          "400": {
            "description": "Invalid ID given",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "401": {
            "description": "User is unauthenticated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "404": {
            "description": "Entry not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/RateLimitResponse"
          }
        },
        "security": [
          {
            "api_key": []
          }
        ]
      }
    },
    "/api/entries/{id}/files": {
      "get": {
        "tags": [
          "entries"
        ],
        "summary": "Files",
        "description": "Get the files associated with an entry.",
        "operationId": "get_entry_files",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "The entry's ID",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "episode",
            "in": "query",
            "description": "Return files that match the given episode number.\n\nThis is a best-effort guess, based off of the filename.\nThis query parameter is also ignored for entries that\nare movies.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/FileEntry"
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid ID given",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "401": {
            "description": "User is unauthenticated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "404": {
            "description": "Entry not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/RateLimitResponse"
          }
        },
        "security": [
          {
            "api_key": []
          }
        ]
      }
    },
    "/api/entries/search": {
      "get": {
        "tags": [
          "entries"
        ],
        "summary": "Search",
        "description": "Returns all entries that meet a specific criteria.",
        "operationId": "search_entries",
        "parameters": [
          {
            "name": "anime",
            "in": "query",
            "description": "Return entries that are anime.",
            "required": false,
            "schema": {
              "type": "boolean",
              "default": true
            }
          },
          {
            "name": "anilist_id",
            "in": "query",
            "description": "Return the entry that has the given AniList ID.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32",
              "nullable": true,
              "minimum": 0
            }
          },
          {
            "name": "tmdb_id",
            "in": "query",
            "description": "Return the entry that has the given TMDB ID.\n\nCheck the documentation for TMDB ID encoding.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true,
              "pattern": "(tv|movie):(\\d+)"
            },
            "example": "tv:12345"
          },
          {
            "name": "query",
            "in": "query",
            "description": "Return entries that match the given string.\n\nCurrently this search is done through a fuzzy\nsearch.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "after",
            "in": "query",
            "description": "Return entries that are after this UNIX timestamp (in seconds).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "before",
            "in": "query",
            "description": "Return entries that are before this UNIX timestamp (in seconds).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Entry"
                  }
                }
              }
            }
          },
          "401": {
            "description": "User is unauthenticated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/RateLimitResponse"
          }
        },
        "security": [
          {
            "api_key": []
          }
        ]
      }
    },
    "/api/entries": {
      "post": {
        "tags": [
          "entries"
        ],
        "summary": "Create",
        "description": "Creates an entry backed by an AniList or TMDB ID.\n\nThis endpoint is atomic. If an entry already exists with\nthe given AniList or TMDB ID then that pre-existing entry\nis returned instead.\n\nAn entry becomes an anime entry if an AniList ID is given.\n\nNote that only API keys bound to editor users can use\nfields other than `tmdb_id` and `anilist_id`.",
        "operationId": "create_entry",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "anilist_id": {
                    "type": "integer",
                    "format": "int32",
                    "description": "Create an entry backed by the given AniList ID.",
                    "nullable": true,
                    "minimum": 0
                  },
                  "english_name": {
                    "type": "string",
                    "description": "Create an entry with the given English name.\n\nThis is only available for API keys bound to editor users.",
                    "nullable": true
                  },
                  "flags": {
                    "allOf": [
                      {
                        "$ref": "#/components/schemas/EntryFlags"
                      }
                    ],
                    "nullable": true
                  },
                  "japanese_name": {
                    "type": "string",
                    "description": "Create an entry with the given Japanese name.\n\nThis is only available for API keys bound to editor users.",
                    "nullable": true
                  },
                  "name": {
                    "type": "string",
                    "description": "Create an entry with the given Romaji name.\n\nThis is only available for API keys bound to editor users.",
                    "nullable": true
                  },
                  "tmdb_id": {
                    "type": "string",
                    "description": "Create an entry backed by the given TMDB ID.\n\nCheck the documentation for the string TMDB ID encoding.",
                    "example": "tv:12345",
                    "nullable": true,
                    "pattern": "(tv|movie):(\\d+)"
                  }
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "required": [
                    "entry_id"
                  ],
                  "properties": {
                    "entry_id": {
                      "type": "integer",
                      "format": "int64",
                      "description": "The resulting entry ID"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "An error occurred",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "401": {
            "description": "User is unauthenticated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "403": {
            "description": "The user does not have permission to do this",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/RateLimitResponse"
          }
        },
        "security": [
          {
            "api_key": []
          }
        ]
      }
    },
    "/api/entries/{id}/upload": {
      "post": {
        "tags": [
          "entries"
        ],
        "summary": "Upload",
        "description": "Upload files to a given entry.\n\nMultiple files can be uploaded at a time. The field name should be\n`file` and the `filename` should point to the subtitle filename.\nYou can have multiple `file` fields.",
        "operationId": "upload_files",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "The entry's ID",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "requestBody": {
          "description": "The files to upload",
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "required": [
                  "file"
                ],
                "properties": {
                  "file": {
                    "type": "array",
                    "items": {
                      "type": "string",
                      "format": "binary"
                    }
                  }
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Upload processed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UploadResult"
                }
              }
            }
          },
          "400": {
            "description": "An error occurred",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "401": {
            "description": "User is unauthenticated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "403": {
            "description": "The user does not have permission to do this",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "404": {
            "description": "Entry not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/RateLimitResponse"
          }
        },
        "security": [
          {
            "api_key": []
          }
        ]
      }
    }
  },
  "components": {
    "schemas": {
      "ApiError": {
        "type": "object",
        "description": "An error type that represents its errors as a JSON response",
        "required": [
          "error",
          "code"
        ],
        "properties": {
          "code": {
            "type": "integer",
            "format": "int32",
            "description": "The associated error code.",
            "minimum": 0
          },
          "error": {
            "type": "string",
            "description": "The error message for this error."
          }
        }
      },
      "Entry": {
        "type": "object",
        "description": "An entry that contains subtitles.\n\nThese are typically backed by e.g. an anilist or tmdb entry to\nfacilitate some features.",
        "required": [
          "id",
          "name",
          "flags",
          "last_modified"
        ],
        "properties": {
          "anilist_id": {
            "type": "integer",
            "format": "int32",
            "description": "The anilist ID of this entry.",
            "example": 154587,
            "nullable": true,
            "minimum": 0
          },
          "creator_id": {
            "type": "integer",
            "format": "int64",
            "description": "The account ID that created this entry",
            "nullable": true
          },
          "english_name": {
            "type": "string",
            "description": "The English name of the entry.",
            "example": "Frieren: Beyond Journey’s End",
            "nullable": true
          },
          "flags": {
            "$ref": "#/components/schemas/EntryFlags"
          },
          "id": {
            "type": "integer",
            "format": "int64",
            "description": "The ID of the entry."
          },
          "japanese_name": {
            "type": "string",
            "description": "The Japanese name of the entry, i.e. with kanji and kana.",
            "example": "葬送のフリーレン",
            "nullable": true
          },
          "last_modified": {
            "type": "string",
            "format": "date-time",
            "description": "The date of the newest uploaded file as an RFC3339 timestamp."
          },
          "name": {
            "type": "string",
            "description": "The romaji name of the entry.",
            "example": "Sousou no Frieren"
          },
          "notes": {
            "type": "string",
            "description": "Extra notes that the entry might have.\n\nSupports a limited set of markdown. Can only be set by editors.",
            "nullable": true
          },
          "tmdb_id": {
            "type": "string",
            "description": "The TMDB ID of this entry.",
            "example": "tv:12345",
            "nullable": true,
            "pattern": "(tv|movie):(\\d+)"
          }
        }
      },
      "EntryFlags": {
        "type": "object",
        "description": "Flags associated with the given entry.",
        "properties": {
          "adult": {
            "type": "boolean",
            "description": "The entry is meant for adult audiences.",
            "example": false
          },
          "anime": {
            "type": "boolean",
            "description": "The entry is for an anime."
          },
          "external": {
            "type": "boolean",
            "description": "The entry comes from an external source.",
            "example": false
          },
          "movie": {
            "type": "boolean",
            "description": "The entry is a movie.",
            "example": false
          },
          "unverified": {
            "type": "boolean",
            "description": "The entry is unverified and has not been checked by editors.",
            "example": false
          }
        }
      },
      "FileEntry": {
        "type": "object",
        "description": "Represents a file entry, e.g. a subtitle or a ZIP file or whatever else.",
        "required": [
          "url",
          "name",
          "size",
          "last_modified"
        ],
        "properties": {
          "last_modified": {
            "type": "string",
            "format": "date-time",
            "description": "The date the file was last modified, in UTC, as an RFC3339 string."
          },
          "name": {
            "type": "string",
            "description": "The file's name."
          },
          "size": {
            "type": "integer",
            "format": "int64",
            "description": "The file's size in bytes.",
            "minimum": 0
          },
          "url": {
            "type": "string",
            "description": "The file's download URL."
          }
        }
      },
      "UploadResult": {
        "type": "object",
        "description": "The result of an upload operation.",
        "required": [
          "errors",
          "total",
          "skipped"
        ],
        "properties": {
          "errors": {
            "type": "integer",
            "description": "The number of files that did not succeed due to a filesystem error.",
            "minimum": 0
          },
          "skipped": {
            "type": "integer",
            "description": "The number of files that were skipped due to some reason",
            "minimum": 0
          },
          "total": {
            "type": "integer",
            "description": "The number of files that were processed.",
            "minimum": 0
          }
        }
      }
    },
    "responses": {
      "RateLimitResponse": {
        "description": "Rate limit exceeded.",
        "headers": {
          "x-ratelimit-limit": {
            "schema": {
              "type": "integer",
              "format": "int32",
              "minimum": 0
            },
            "description": "The number of requests you can make"
          },
          "x-ratelimit-remaining": {
            "schema": {
              "type": "integer",
              "format": "int32",
              "minimum": 0
            },
            "description": "The number of requests remaining"
          },
          "x-ratelimit-reset": {
            "schema": {
              "type": "number",
              "format": "float"
            },
            "description": "The time, in UNIX timestamp seconds, when you can make requests again. Note this has a fractional component for milliseconds."
          },
          "x-ratelimit-reset-after": {
            "schema": {
              "type": "number",
              "format": "float"
            },
            "description": "The number of seconds before you can try again. Note this has a fractional component for milliseconds."
          }
        },
        "content": {
          "application/json": {
            "schema": {
              "type": "object",
              "description": "An error type that represents its errors as a JSON response",
              "required": [
                "error",
                "code"
              ],
              "properties": {
                "code": {
                  "type": "integer",
                  "format": "int32",
                  "description": "The associated error code.",
                  "minimum": 0
                },
                "error": {
                  "type": "string",
                  "description": "The error message for this error."
                }
              }
            }
          }
        }
      }
    },
    "securitySchemes": {
      "api_key": {
        "type": "apiKey",
        "in": "header",
        "name": "Authorization"
      }
    }
  },
  "tags": [
    {
      "name": "entries",
      "description": "Working with entries on the site"
    }
  ]
}